var aws=require("aws-sdk"),response=require("cfn-response");aws.config.region=process.env.AWS_REGION;var cc=new aws.CodeCommit;exports.handler=function(event,context,callback){console.log(JSON.stringify(event,null,2));var params=event.ResourceProperties;delete params.ServiceToken,cc.getRepositoryTriggers({repositoryName:params.repositoryName}).promise().then(function(result){var triggers=result.triggers.filter(x=>x.name!==params.trigger.name);return"Delete"!==event.RequestType&&triggers.push(params.trigger),cc.putRepositoryTriggers({repositoryName:params.repositoryName,triggers:triggers}).promise()}).then(()=>response.send(event,context,response.SUCCESS)).catch(e=>{console.log(e),response.send(event,context,response.FAILED)})};